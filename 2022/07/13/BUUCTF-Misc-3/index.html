<!DOCTYPE html><html lang="zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>BUUCTF Misc wp大合集(3) | Loving Strangers</title><meta name="author" content="Ivy"><meta name="copyright" content="Ivy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言之前做杂项的题比较佛，主要是比赛里面考的大多是脑洞，弯路多，有时候没有hint挺难找到思路，做多了也没什么提升，还是喜欢实打实的脚本题和取证分析。4月25号到五一假期结束那段时间，一口气刷了五页题，实际上考点就那些。小学期搞完了之后，来总结一下知识体系，有些很简单的签到题就一语带过了，用到脚本的题，我会把代码贴上去 题解第三页[sqltest]导出对象→HTTP 这里攻击者使用的是布尔盲注的方">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF Misc wp大合集(3)">
<meta property="og:url" content="http://example.com/2022/07/13/BUUCTF-Misc-3/index.html">
<meta property="og:site_name" content="Loving Strangers">
<meta property="og:description" content="前言之前做杂项的题比较佛，主要是比赛里面考的大多是脑洞，弯路多，有时候没有hint挺难找到思路，做多了也没什么提升，还是喜欢实打实的脚本题和取证分析。4月25号到五一假期结束那段时间，一口气刷了五页题，实际上考点就那些。小学期搞完了之后，来总结一下知识体系，有些很简单的签到题就一语带过了，用到脚本的题，我会把代码贴上去 题解第三页[sqltest]导出对象→HTTP 这里攻击者使用的是布尔盲注的方">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/img/%E5%B0%81%E9%9D%A2.jpg">
<meta property="article:published_time" content="2022-07-13T08:49:21.000Z">
<meta property="article:modified_time" content="2022-11-27T09:16:09.301Z">
<meta property="article:author" content="Ivy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/%E5%B0%81%E9%9D%A2.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2022/07/13/BUUCTF-Misc-3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BUUCTF Misc wp大合集(3)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-27 17:16:09'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/iu.gif" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">25</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/%E5%B0%81%E9%9D%A2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Loving Strangers</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUCTF Misc wp大合集(3)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-07-13T08:49:21.000Z" title="Created 2022-07-13 16:49:21">2022-07-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-11-27T09:16:09.301Z" title="Updated 2022-11-27 17:16:09">2022-11-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUCTF Misc wp大合集(3)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前做杂项的题比较佛，主要是比赛里面考的大多是脑洞，弯路多，有时候没有hint挺难找到思路，做多了也没什么提升，还是喜欢实打实的脚本题和取证分析。4月25号到五一假期结束那段时间，一口气刷了五页题，实际上考点就那些。小学期搞完了之后，来总结一下知识体系，有些很简单的签到题就一语带过了，用到脚本的题，我会把代码贴上去</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><h2 id="第三页"><a href="#第三页" class="headerlink" title="第三页"></a>第三页</h2><h3 id="sqltest"><a href="#sqltest" class="headerlink" title="[sqltest]"></a>[sqltest]</h3><p>导出对象→HTTP</p>
<p>这里攻击者使用的是布尔盲注的方式（爆破数据库信息每一个字符的ASCII值）进行攻击</p>
<p><img src="/1-5/91.png" alt="91"></p>
<p>这一部分是猜解数据库的个数，结果为5（5的ASCII值是53）</p>
<p><img src="/1-5/92.png" alt="92"></p>
<p>这一部分是在猜解数据库的库名长度</p>
<p><img src="/1-5/93.png" alt="93"></p>
<p>这一部分是在逐字符猜解数据库的库名，结果为information_schema，tb_flag等等（数据有点乱，其他的看不太出来）</p>
<p><img src="/1-5/94.png" alt="94"></p>
<p>这一部分是在猜解db_flag库中的表名长度和表名，长度为7，表名为tb_flag</p>
<p><img src="/1-5/95.png" alt="95"></p>
<p>这一部分是在猜解tb_flag表中的列名，为flag</p>
<p><img src="/1-5/96.png" alt="96"></p>
<p>这一部分是在猜解flag列中的字符串长度和字符串各位情况，爆破每一位的数据即得flag</p>
<h3 id="SWPU2019-你有没有好好看网课"><a href="#SWPU2019-你有没有好好看网课" class="headerlink" title="[SWPU2019 你有没有好好看网课?]"></a>[SWPU2019 你有没有好好看网课?]</h3><p>下载的压缩包解压之后有两个带密码的压缩包，其中一个根据备注可以爆破密码</p>
<p><img src="/1-5/97.png" alt="97"><img src="/1-5/98.png" alt="98"></p>
<p>爆破之后有一个文档和一个视频，文档里头的关键信息是5.20和7.11</p>
<p>视频用Kinova打开，在这个区间内的5.66s处发现敲击码（我的Kinova出bug了，截不了图）</p>
<p>在7.36s处发现一段base64，解码之后和前一段敲击码连接得到flag2压缩包的密码wllmup_up_up</p>
<p>打开flag2，把图片拖入winhex，拉到最下面得到flag</p>
<p><img src="/1-5/99.png" alt="99"></p>
<h3 id="SUCTF2018-single-dog"><a href="#SUCTF2018-single-dog" class="headerlink" title="[SUCTF2018 single dog]"></a>[SUCTF2018 single dog]</h3><p>把图片拖入winhex，在最下面发现zip的文件头PK<img src="/1-5/100.png" alt="100"></p>
<p>foremost分离出来得压缩包，解压之后里头一个全是颜文字的txt</p>
<p>这种加密方式叫aaencode，常用于js中</p>
<p><img src="/1-5/102.png" alt="102"></p>
<h3 id="我吃三明治"><a href="#我吃三明治" class="headerlink" title="[我吃三明治]"></a>[我吃三明治]</h3><p>把图片拖入winhex，发现这张图片是由两张图片合成的，在拼接处有一串base32</p>
<p><img src="/1-5/103.png" alt="103"></p>
<p>解码得flag</p>
<p><img src="/1-5/104.png" alt="104"></p>
<h3 id="ACTF新生赛2020-NTFS数据流"><a href="#ACTF新生赛2020-NTFS数据流" class="headerlink" title="[ACTF新生赛2020 NTFS数据流]"></a>[ACTF新生赛2020 NTFS数据流]</h3><p>下载得到500个txt文件，看了前面几个都说是flag is not here</p>
<p>于是按大小排序</p>
<p><img src="/1-5/105.png" alt="105"></p>
<p>序号为293的txt内容最多，根据提示是NTFS流隐写</p>
<p>使用工具NtfsStreamsEditor</p>
<p><img src="/1-5/106.png" alt="106"></p>
<h3 id="john-in-the-middle"><a href="#john-in-the-middle" class="headerlink" title="[john-in-the-middle]"></a>[john-in-the-middle]</h3><p>这个流量包里面传输的HTTP对象比较多，于是全部导出</p>
<p>发现logo.png上面有一条裂缝</p>
<p><img src="/1-5/107.png" alt="107"></p>
<p>用stegsolve打开scanlines.png时发现一条黑线</p>
<p><img src="/1-5/108.png" alt="108"></p>
<p>使用Image Combiner功能将两张图进行对比</p>
<p><img src="/1-5/109.png" alt="109"></p>
<h3 id="喵喵喵"><a href="#喵喵喵" class="headerlink" title="[喵喵喵]"></a>[喵喵喵]</h3><p>zsteg分析图片</p>
<p><img src="/1-5/110.png" alt="110"></p>
<p>发现在一个通道下隐写了一个文件</p>
<p>用stegsolve打开</p>
<p><img src="/1-5/111.png" alt="111"></p>
<p>保存为png格式的图片，发现打不开，拖进winhex里头修改16进制数值</p>
<p><img src="/1-5/112.png" alt="112"></p>
<p>修改文件头之后可以看到是半张二维码</p>
<p>于是猜测可能宽高被修改，用脚本爆破</p>
<p><img src="/1-5/113.png" alt="113"></p>
<p>修改宽高之后扫描二维码得到一个地址</p>
<p>下载下来解压之后的文档内容和上上个题类似</p>
<p>追踪NTFS得到Python的一个编译文件，反编译之后得到代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit http://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>():</span></span><br><span class="line">    flag = <span class="string">&#x27;*************&#x27;</span></span><br><span class="line">    ciphertext = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        s = <span class="built_in">chr</span>(i ^ <span class="built_in">ord</span>(flag[i]))</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            s = <span class="built_in">ord</span>(s) + <span class="number">10</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s = <span class="built_in">ord</span>(s) - <span class="number">10</span></span><br><span class="line">        ciphertext.append(<span class="built_in">str</span>(s))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ciphertext[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">ciphertext = [</span><br><span class="line">    <span class="string">&#x27;96&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;65&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;93&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;123&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;91&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;97&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;22&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;93&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;70&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;102&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;94&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;132&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;46&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;112&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;64&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;97&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;88&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;80&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;82&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;137&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;90&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;109&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;99&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;112&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解密脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ciphertext = [</span><br><span class="line">    <span class="string">&#x27;96&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;65&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;93&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;123&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;91&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;97&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;22&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;93&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;70&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;102&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;94&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;132&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;46&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;112&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;64&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;97&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;88&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;80&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;82&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;137&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;90&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;109&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;99&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;112&#x27;</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">    s = <span class="built_in">int</span>(ciphertext[<span class="number">23</span>-i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        s = s - <span class="number">10</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = s + <span class="number">10</span></span><br><span class="line">    <span class="built_in">print</span>(s)</span><br><span class="line">    char = <span class="built_in">chr</span>(i ^ s)</span><br><span class="line">    flag = flag + <span class="built_in">str</span>(char)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="Mysterious"><a href="#Mysterious" class="headerlink" title="[Mysterious]"></a>[Mysterious]</h3><p>32位exe文件，打开后是一个对话框，输入小于6位的字符串之后点crack没有反应，大于6位的字符串直接闪退</p>
<p>用IDA反编译</p>
<p><img src="/1-5/114.png" alt="114"></p>
<p>可以看到调用了DialogBoxParam函数，即对话框的操作</p>
<p>点进去看，到sub_401090这个函数里头</p>
<p><img src="/1-5/115.png" alt="115"></p>
<p>可知这个函数的功能是读取用户输入的字符串，判断是否满足条件则输出flag</p>
<p>首先字符串长度必须为6，若大于6则直接退出，而输出flag的条件是整型的v10=123，字符型的v12=’x’，v13=’y’，v14=’z’</p>
<p>而v10是将用户输入字符串转换为整型后+1得到的</p>
<p>查看堆栈中变量的情况</p>
<p><img src="/1-5/116.png" alt="116"></p>
<p>可知输入的字符串为6位，对应的字符串即为str(v10-1)+v12+v13+v14</p>
<p>输入122xyz得到flag</p>
<p><img src="/1-5/117.png" alt="117"></p>
<h3 id="ACTF新生赛2020-swp"><a href="#ACTF新生赛2020-swp" class="headerlink" title="[ACTF新生赛2020 swp]"></a>[ACTF新生赛2020 swp]</h3><p>包很多，直接导出HTTP对象，这里有一个比较可疑的secrets.zip</p>
<p><img src="/1-5/118.png" alt="118"></p>
<p>解压这个压缩包，得到一个flag.swp文件，不用复制到linux里面去运行，直接拖到winhex里面往下拉就能找到flag</p>
<p><img src="/1-5/119.png" alt="119"></p>
<h3 id="GXYCTF2019-SXMgdGhpcyBiYXNlPw"><a href="#GXYCTF2019-SXMgdGhpcyBiYXNlPw" class="headerlink" title="[GXYCTF2019 SXMgdGhpcyBiYXNlPw==]"></a>[GXYCTF2019 SXMgdGhpcyBiYXNlPw==]</h3><p>题目中base64字符串解码的结果为Is this base?</p>
<p>猜测base64隐写，直接跑脚本即可</p>
<h3 id="弱口令"><a href="#弱口令" class="headerlink" title="[弱口令]"></a>[弱口令]</h3><p>用winrar打开压缩包，在注释里有一段隐藏的字符串</p>
<p>复制到sublimetext里面全选</p>
<p><img src="/1-5/120.png" alt="120"></p>
<p>这里是摩斯电码，翻译过来之后是HELL0FORUM，这个就是压缩包的密码</p>
<p>这个图片不是常规的lsb隐写，需要用到脚本cloacked-pixel</p>
<p><a target="_blank" rel="noopener" href="https://github.com/livz/cloacked-pixel"></a></p>
<p>根据题目，弱口令猜测为123456</p>
<p>跑脚本得到flag</p>
<p>python lsb.py extract 女神.png flag.txt 123456</p>
<h3 id="间谍启示录"><a href="#间谍启示录" class="headerlink" title="[间谍启示录]"></a>[间谍启示录]</h3><p>foremost分离这个iso文件，在rar里面有一个flag.exe，拖到windows里面运行即得flag（注意在文件夹里面选择查看隐藏项目）</p>
<h3 id="RoarCTF2019-黄金6年"><a href="#RoarCTF2019-黄金6年" class="headerlink" title="[RoarCTF2019 黄金6年]"></a>[RoarCTF2019 黄金6年]</h3><p>视频拖到Kinova里面逐帧查看</p>
<p><img src="/1-5/121.png" alt="121"></p>
<p>​                                    <img src="/1-5/122.png" alt="122">                                                                        <img src="/1-5/123.png" alt="123"></p>
<p>​                                  <img src="/1-5/124.png" alt="124"></p>
<p>挨个扫码得到字符串iwantplayctf</p>
<p>把视频拖入winhex，拉到最下面看到一串字符串</p>
<p><img src="/1-5/126.png" alt="126"></p>
<p>可以看到这个是一个rar压缩包，保存下来，用刚才那个字符串解压缩得到flag</p>
<h3 id="小易的U盘"><a href="#小易的U盘" class="headerlink" title="[小易的U盘]"></a>[小易的U盘]</h3><p>解压iso文件，autorun.inf中的内容如下</p>
<p><img src="/1-5/127.png" alt="127"></p>
<p>运行对应的exe文件，发现报错，于是拖到ida里面分析</p>
<p><img src="/1-5/128.png" alt="128"></p>
<p>flag就在这里，大概的意思是创建一个txt文件，把flag写入</p>
<h3 id="zip"><a href="#zip" class="headerlink" title="[zip]"></a>[zip]</h3><p>这个压缩包里面有很多小压缩包，但都不是伪加密，也不能用无格式文本爆破</p>
<p>由于每个压缩包中包含的文件大小都是4字节，可以考虑通过CRC32爆破获得其中的值</p>
<p>脚本如下（路径因人而异）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span>(<span class="params">crc</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> h <span class="keyword">in</span> dic:</span><br><span class="line">                    s = i + j + k + h</span><br><span class="line">                    <span class="keyword">if</span> crc == (binascii.crc32(s.encode())):</span><br><span class="line">                        f.write(s)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackZip</span>():</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">68</span>):</span><br><span class="line">            file = <span class="string">&#x27;./3/out&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.zip&#x27;</span></span><br><span class="line">            crc = zipfile.ZipFile(file,<span class="string">&#x27;r&#x27;</span>).getinfo(<span class="string">&#x27;data.txt&#x27;</span>).CRC</span><br><span class="line">            CrackCrc(crc)</span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters + string.digits + <span class="string">&#x27;+/=&#x27;</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./3/out.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">CrackZip()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;CRC32碰撞完成&quot;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<img src="/1-5/129.png" alt="129" style="zoom: 80%;" />

<p>C4 3D 7B 00 40 07 00是rar文件的结尾，于是加上文件头之后便可以得到压缩包</p>
<p>在注释中可以看到flag</p>
<h3 id="安洵杯-2019-吹着贝斯扫二维码"><a href="#安洵杯-2019-吹着贝斯扫二维码" class="headerlink" title="[安洵杯 2019 吹着贝斯扫二维码]"></a>[安洵杯 2019 吹着贝斯扫二维码]</h3><p>下载的压缩包里头有很多无格式的文件，拖到winhex里面发现文件头是FF D8 FF E0，即jpg格式，于是全部重命名，脚本参考：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BatchRename</span>():</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rename</span>(<span class="params">self</span>):</span></span><br><span class="line">        path = <span class="string">&quot;文件路径&quot;</span></span><br><span class="line">        filelist = os.listdir(path)</span><br><span class="line">        total_num = <span class="built_in">len</span>(filelist)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> filelist:</span><br><span class="line">            <span class="keyword">if</span> item.endswith(<span class="string">&#x27;.png&#x27;</span>):</span><br><span class="line">                src = os.path.join(os.path.abspath(path), item)</span><br><span class="line">                dst = os.path.join(os.path.abspath(path), <span class="string">&#x27;&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    os.rename(src, dst)</span><br><span class="line">                    i += <span class="number">1</span></span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;total %d to rename &amp; converted %d png&#x27;</span>%(total_num, i))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    demo = BatchRename()</span><br><span class="line">    demo.rename()</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「全部梭哈一夜暴富」的原创文章，遵循CC <span class="number">4.0</span> BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https://blog.csdn.net/AI_girl/article/details/<span class="number">124143162</span></span><br></pre></td></tr></table></figure>

<p>将图片拖入winhex中，拉到最下，看到末尾有一个数字，每个图片的数字都不一样，这个应该就是图片序号</p>
<p><img src="/1-5/130.png" alt="130"></p>
<p>于是写脚本读取文件的最后两个字节，将其作为文件名重命名文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment">#目录路径</span></span><br><span class="line">dir_name = <span class="string">r&quot;./&quot;</span></span><br><span class="line"><span class="comment">#获取目录下文件名列表</span></span><br><span class="line">dir_list = os.listdir(<span class="string">&#x27;./&#x27;</span>)</span><br><span class="line"><span class="comment">#print(dir_list)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#从列表中依次读取文件</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> dir_list:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;.jpg&#x27;</span> <span class="keyword">in</span> file:</span><br><span class="line">        f=<span class="built_in">open</span>(file ,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">        n1 = <span class="built_in">str</span>(f.read())</span><br><span class="line">        n2 = n1[-<span class="number">3</span>:]	</span><br><span class="line">        <span class="comment">#经过测试发现这里要读取最后3个字节，因为最后还有一个多余的字节，不知道是不是转字符串的原因导致在末尾多了一个字符</span></span><br><span class="line">        <span class="comment">#print(file) #输出文件内容</span></span><br><span class="line">        <span class="comment">#print(n2)</span></span><br><span class="line">        f.close()	<span class="comment">#先关闭文件才能重命名，否则会报`文件被占用`错误</span></span><br><span class="line">        os.rename(file,n2+<span class="string">&#x27;.jpg&#x27;</span>)	<span class="comment">#重命名文件</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>根据图片的序号，用PS拼接到一起，得到一张二维码</p>
<p>扫描结果为</p>
<p>BASE Family Bucket ???<br>85-&gt;64-&gt;85-&gt;13-&gt;16-&gt;32</p>
<p>回到flag.zip，用winrar打开看到注释中有一串base</p>
<p><img src="/1-5/131.png" alt="131"></p>
<p>于是按照顺序反向解码，13指的是rot13</p>
<h3 id="UTCTF2020-docx"><a href="#UTCTF2020-docx" class="headerlink" title="[UTCTF2020 docx]"></a>[UTCTF2020 docx]</h3><p>修改文档的格式为zip，解压之后在word/media路径下找到写有flag的图片<img src="/1-5/132.png" alt="132"></p>
<h3 id="WUSTCTF2020-alison-likes-jojo"><a href="#WUSTCTF2020-alison-likes-jojo" class="headerlink" title="[WUSTCTF2020 alison_likes_jojo]"></a>[WUSTCTF2020 alison_likes_jojo]</h3><p>解压得到两张图片，把boki.jpg拖到winhex里面，在最下面发现zip文件头，于是foremost分离出来</p>
<p>得到一个有密码的压缩包</p>
<p>尝试爆破</p>
<p><img src="/1-5/133.png" alt="133"></p>
<p>解压得到一串base64</p>
<p>WVRKc2MySkhWbmxqV0Zac1dsYzBQUT09，三次解码后得到字符串killerqueen</p>
<p>jljy.jpg是outguess隐写，跑脚本</p>
<p><img src="/1-5/134.png" alt="134"></p>
<h3 id="WUSTCTF2020-爬"><a href="#WUSTCTF2020-爬" class="headerlink" title="[WUSTCTF2020 爬]"></a>[WUSTCTF2020 爬]</h3><p>文件最开始没有格式，拖入winhex查看，文件头是PDF，于是修改后缀<img src="/1-5/135.png" alt="135"></p>
<p>在WPS图片里面把这个图片删除，看到一串16进制</p>
<p><img src="/1-5/136.png" alt="136"></p>
<p>转成字符串得flag</p>
<p><img src="/1-5/137.png" alt="137"></p>
<h3 id="GUET-CTF2019-zips"><a href="#GUET-CTF2019-zips" class="headerlink" title="[GUET-CTF2019 zips]"></a>[GUET-CTF2019 zips]</h3><p>对于222.zip，没有其他的hint，考虑对其进行爆破（6位数字）</p>
<p>之后得到111.zip，拖入winhex查看，发现是由flag.zip和setup.sh拼接而成，前者未加密</p>
<p><img src="/1-5/138.png" alt="139"></p>
<p>发现setup.sh是伪加密，修改加密位之后可以解压打开<img src="/1-5/140.png" alt="140"></p>
<p>是将时间戳作为了flag.zip的密码，于是根据创建这个文件的时间换算成时间戳</p>
<p><img src="/1-5/139.png" alt="139"></p>
<p>密码的格式如下，10位整数+2位小数</p>
<p><img src="/1-5/141.png" alt="141"></p>
<p>于是进行掩码爆破</p>
<p><img src="/1-5/142.png" alt="142"></p>
<p>解压得到flag</p>
<h3 id="从娃娃抓起"><a href="#从娃娃抓起" class="headerlink" title="[从娃娃抓起]"></a>[从娃娃抓起]</h3><p>题目提示如下：</p>
<p><img src="/1-5/143.png" alt="143"></p>
<p>盲猜是在南海画圈的老人说过的话</p>
<p><img src="/1-5/144.png" alt="144"></p>
<p>前一段是中文电码，后一段是五笔编码</p>
<h3 id="DDCTF2018-╯°□°）╯︵-┻━┻"><a href="#DDCTF2018-╯°□°）╯︵-┻━┻" class="headerlink" title="[DDCTF2018 (╯°□°）╯︵ ┻━┻]"></a>[DDCTF2018 (╯°□°）╯︵ ┻━┻]</h3><p>先将d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd</p>
<p>转换成16进制数表示的形式，即每两位之前加一个0x，接着每个数减去0x80，最后转ASCII得到flag</p>
<p>我也不知道为什么要减去0x80，有一点点小脑洞</p>
<h3 id="MRCTF2020-千层套路"><a href="#MRCTF2020-千层套路" class="headerlink" title="[MRCTF2020 千层套路]"></a>[MRCTF2020 千层套路]</h3><p>可以先尝试爆破，发现每个压缩包的密码都是其名字，于是写脚本循环解压</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line">path = <span class="string">r&quot;C://Users//hp//Desktop//attachment&quot;</span></span><br><span class="line"></span><br><span class="line">file = <span class="string">r&quot;//0573.zip//0573.zip&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(file) != <span class="number">4</span>:</span><br><span class="line">    pwd = file[<span class="number">2</span>:<span class="number">6</span>]</span><br><span class="line">    <span class="built_in">print</span>(pwd)</span><br><span class="line">    zip_file = zipfile.ZipFile(path+file)</span><br><span class="line">    zip_list = zip_file.namelist()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> zip_list:</span><br><span class="line">        zip_file.extractall(i, pwd=pwd.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    file = <span class="string">&quot;//&quot;</span>+zip_list[<span class="number">0</span>]+<span class="string">&quot;//&quot;</span>+zip_list[<span class="number">0</span>]</span><br><span class="line">    zip_file.close()</span><br></pre></td></tr></table></figure>

<p>运行到最后可以得到一个写满RGB信息的txt文件qr.txt</p>
<p>写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;qr.txt&#x27;</span>)</span><br><span class="line">MAX = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">picture = Image.new(<span class="string">&quot;RGB&quot;</span>, (MAX, MAX))</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(MAX):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(MAX):</span><br><span class="line">        string = file.readline()</span><br><span class="line">        picture.putpixel([x, y], <span class="built_in">eval</span>(string))  <span class="comment"># 直接使用eval()可以转为元组</span></span><br><span class="line">picture.show()</span><br></pre></td></tr></table></figure>

<p>扫描二维码即可得flag</p>
<h3 id="WUSTCTF2020-girlfriend"><a href="#WUSTCTF2020-girlfriend" class="headerlink" title="[WUSTCTF2020 girlfriend]"></a>[WUSTCTF2020 girlfriend]</h3><p>这个音频听起来像电话的拨号音</p>
<p>使用工具dtmf2num来识别</p>
<p><img src="/1-5/145.png" alt="145"></p>
<p>得到的结果是手机键盘密码，即使用9键时的输入结果</p>
<p>为youaremygirlfriends</p>
<h3 id="百里挑一"><a href="#百里挑一" class="headerlink" title="[百里挑一]"></a>[百里挑一]</h3><p>这个里头传输的图片很多，于是全部导出为HTTP对象，大致看了一遍也没有发现特殊的图片</p>
<p>于是用Exiftool工具（类似于查找图片的备注等信息）</p>
<p><img src="/1-5/146.png" alt="146"></p>
<p>找到一半，另一半在流114里面，说实话这个挺坑的</p>
<p><img src="/1-5/147.png" alt="147"></p>
<h3 id="XMAN2018排位赛-通行证"><a href="#XMAN2018排位赛-通行证" class="headerlink" title="[XMAN2018排位赛 通行证]"></a>[XMAN2018排位赛 通行证]</h3><p>base64→栅栏→凯撒</p>
<p><img src="/1-5/148.png" alt="148"><img src="/1-5/149.png" alt="149"><img src="/1-5/150.png" alt="150"></p>
<h3 id="安洵杯2019-Attack"><a href="#安洵杯2019-Attack" class="headerlink" title="[安洵杯2019 Attack]"></a>[安洵杯2019 Attack]</h3><p>搜索字符串flag，定位到一个TCP流</p>
<p><img src="/1-5/151.png" alt="151"></p>
<p>base64解码上面的字符串，大致意思是上传下面这个压缩包</p>
<p>可以用foremost分离出来，得到带密码的压缩包<img src="/1-5/152.png" alt="152"></p>
<p>提示为管理员的秘密，回到流量包里面导出HTTP对象</p>
<p>发现一个dmp文件（在windows系统出现蓝屏等问题时会自动将错误的堆栈信息、用户名密码等保存在dmp文件中）</p>
<p><img src="/1-5/153.png" alt="153"></p>
<p>使用mimikatz工具来分析（以管理员身份运行）<img src="/1-5/154.png" alt="154"></p>
<p>用这个密码解压压缩包即可得flag</p>
<h3 id="SUCTF2018-followme"><a href="#SUCTF2018-followme" class="headerlink" title="[SUCTF2018 followme]"></a>[SUCTF2018 followme]</h3><p>直接搜索字符串ctf</p>
<p><img src="/1-5/155.png" alt="155"></p>
<h3 id="MRCTF2020-CyberPunk"><a href="#MRCTF2020-CyberPunk" class="headerlink" title="[MRCTF2020 CyberPunk]"></a>[MRCTF2020 CyberPunk]</h3><p>不用逆向，直接把系统时间改成2020年9月17日就可以了</p>
<p><img src="/1-5/156.png" alt="156"></p>
<h3 id="SUCTF2019-Game"><a href="#SUCTF2019-Game" class="headerlink" title="[SUCTF2019 Game]"></a>[SUCTF2019 Game]</h3><p>在src的index.html发现一串”flag”，base32解码之后得到fake flag</p>
<p><img src="/1-5/157.png" alt="157"></p>
<p>将图片用stegsolve打开，发现lsb隐写了</p>
<p><img src="/1-5/158.png" alt="158"></p>
<p>解码一下</p>
<p><img src="/1-5/159.png" alt="159"></p>
<p>头部是Salted，于是加密方式应该是AES或3DES，密钥是刚才那个fake flag<img src="/1-5/160.png" alt="160"></p>
<h3 id="USB"><a href="#USB" class="headerlink" title="[USB]"></a>[USB]</h3><p>把key.ftm拖入winhex，发现zip的文件头</p>
<p><img src="/1-5/161.png" alt="161"></p>
<p>foremost分离一下，解压得到key.pcap，里面是USB数据包</p>
<p><img src="/1-5/162.png" alt="162"></p>
<p>使用工具UsbKeyboardDataHacker提取内容</p>
<p><img src="/1-5/163.png" alt="163"></p>
<p>key{xinan}</p>
<p>对于233.rar，其大小有1581kb，然而能解压出来的只有一个1kb的txt文件，拖入winhex分析</p>
<p><img src="/1-5/164.png" alt="164"></p>
<p>发现还有一个文件233.png，猜测是校验错误导致解压不出来</p>
<p>RAR文件结构参考：</p>
<p><img src="/1-5/165.png" alt="165"></p>
<p>于是在刚才这个rar文件中</p>
<p><img src="/1-5/166.png" alt="166"></p>
<p>0x16这个位置上的块类型应该为0x74，修改之后可以正常解压</p>
<p>将233.png用stegsolve打开，在Blue plane0通道下看到二维码<img src="/1-5/167.png" alt="167"></p>
<p>扫描二维码得到ci{v3erf_0tygidv2_fc0}</p>
<p>根据最开始得到的key{xinan}，猜测是维吉尼亚密码</p>
<p><img src="/1-5/168.png" alt="168"></p>
<p>最后是栅栏密码</p>
<p><img src="/1-5/169.png" alt="169"></p>
<h3 id="UTCTF2020-file-header"><a href="#UTCTF2020-file-header" class="headerlink" title="[UTCTF2020 file header]"></a>[UTCTF2020 file header]</h3><p>拖入winhex，发现缺少png的文件头<img src="/1-5/170.png" alt="170"></p>
<p>补上去就可以看到flag了</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Ivy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2022/07/13/BUUCTF-Misc-3/">http://example.com/2022/07/13/BUUCTF-Misc-3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/%E5%B0%81%E9%9D%A2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/10/23/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C1%E2%80%94%E2%80%94%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%A0%B4%E8%A7%A3/"><img class="prev-cover" src="/img/%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">软件安全实验1——小程序破解</div></div></a></div><div class="next-post pull-right"><a href="/2022/07/10/BUUCTF-Misc-2/"><img class="next-cover" src="/img/%E5%B0%81%E9%9D%A2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">BUUCTF Misc wp大合集(2)</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/iu.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Ivy</div><div class="author-info__description">blog</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">25</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/1vyyyyyy"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">个人学习笔记，满意的内容会放上来</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">题解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%A1%B5"><span class="toc-number">3.</span> <span class="toc-text">第三页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sqltest"><span class="toc-number">3.1.</span> <span class="toc-text">[sqltest]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SWPU2019-%E4%BD%A0%E6%9C%89%E6%B2%A1%E6%9C%89%E5%A5%BD%E5%A5%BD%E7%9C%8B%E7%BD%91%E8%AF%BE"><span class="toc-number">3.2.</span> <span class="toc-text">[SWPU2019 你有没有好好看网课?]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF2018-single-dog"><span class="toc-number">3.3.</span> <span class="toc-text">[SUCTF2018 single dog]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E5%90%83%E4%B8%89%E6%98%8E%E6%B2%BB"><span class="toc-number">3.4.</span> <span class="toc-text">[我吃三明治]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-NTFS%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="toc-number">3.5.</span> <span class="toc-text">[ACTF新生赛2020 NTFS数据流]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#john-in-the-middle"><span class="toc-number">3.6.</span> <span class="toc-text">[john-in-the-middle]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5"><span class="toc-number">3.7.</span> <span class="toc-text">[喵喵喵]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mysterious"><span class="toc-number">3.8.</span> <span class="toc-text">[Mysterious]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-swp"><span class="toc-number">3.9.</span> <span class="toc-text">[ACTF新生赛2020 swp]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-SXMgdGhpcyBiYXNlPw"><span class="toc-number">3.10.</span> <span class="toc-text">[GXYCTF2019 SXMgdGhpcyBiYXNlPw&#x3D;&#x3D;]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="toc-number">3.11.</span> <span class="toc-text">[弱口令]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%B4%E8%B0%8D%E5%90%AF%E7%A4%BA%E5%BD%95"><span class="toc-number">3.12.</span> <span class="toc-text">[间谍启示录]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF2019-%E9%BB%84%E9%87%916%E5%B9%B4"><span class="toc-number">3.13.</span> <span class="toc-text">[RoarCTF2019 黄金6年]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%98%93%E7%9A%84U%E7%9B%98"><span class="toc-number">3.14.</span> <span class="toc-text">[小易的U盘]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip"><span class="toc-number">3.15.</span> <span class="toc-text">[zip]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-%E5%90%B9%E7%9D%80%E8%B4%9D%E6%96%AF%E6%89%AB%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="toc-number">3.16.</span> <span class="toc-text">[安洵杯 2019 吹着贝斯扫二维码]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UTCTF2020-docx"><span class="toc-number">3.17.</span> <span class="toc-text">[UTCTF2020 docx]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-alison-likes-jojo"><span class="toc-number">3.18.</span> <span class="toc-text">[WUSTCTF2020 alison_likes_jojo]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-%E7%88%AC"><span class="toc-number">3.19.</span> <span class="toc-text">[WUSTCTF2020 爬]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GUET-CTF2019-zips"><span class="toc-number">3.20.</span> <span class="toc-text">[GUET-CTF2019 zips]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%A8%83%E5%A8%83%E6%8A%93%E8%B5%B7"><span class="toc-number">3.21.</span> <span class="toc-text">[从娃娃抓起]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DDCTF2018-%E2%95%AF%C2%B0%E2%96%A1%C2%B0%EF%BC%89%E2%95%AF%EF%B8%B5-%E2%94%BB%E2%94%81%E2%94%BB"><span class="toc-number">3.22.</span> <span class="toc-text">[DDCTF2018 (╯°□°）╯︵ ┻━┻]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-%E5%8D%83%E5%B1%82%E5%A5%97%E8%B7%AF"><span class="toc-number">3.23.</span> <span class="toc-text">[MRCTF2020 千层套路]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-girlfriend"><span class="toc-number">3.24.</span> <span class="toc-text">[WUSTCTF2020 girlfriend]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BE%E9%87%8C%E6%8C%91%E4%B8%80"><span class="toc-number">3.25.</span> <span class="toc-text">[百里挑一]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XMAN2018%E6%8E%92%E4%BD%8D%E8%B5%9B-%E9%80%9A%E8%A1%8C%E8%AF%81"><span class="toc-number">3.26.</span> <span class="toc-text">[XMAN2018排位赛 通行证]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF2019-Attack"><span class="toc-number">3.27.</span> <span class="toc-text">[安洵杯2019 Attack]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF2018-followme"><span class="toc-number">3.28.</span> <span class="toc-text">[SUCTF2018 followme]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRCTF2020-CyberPunk"><span class="toc-number">3.29.</span> <span class="toc-text">[MRCTF2020 CyberPunk]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF2019-Game"><span class="toc-number">3.30.</span> <span class="toc-text">[SUCTF2019 Game]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#USB"><span class="toc-number">3.31.</span> <span class="toc-text">[USB]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UTCTF2020-file-header"><span class="toc-number">3.32.</span> <span class="toc-text">[UTCTF2020 file header]</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/09/NSSCTF-Round-11-Writeup/" title="NSSCTF Round#11 Writeup">NSSCTF Round#11 Writeup</a><time datetime="2023-04-09T06:51:05.000Z" title="Created 2023-04-09 14:51:05">2023-04-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/07/CVE-2019-5736-docker-runc%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2019-5736 docker runc逃逸漏洞复现">CVE-2019-5736 docker runc逃逸漏洞复现</a><time datetime="2023-04-06T16:50:16.000Z" title="Created 2023-04-07 00:50:16">2023-04-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/02/%E7%99%B8%E5%8D%AF%E4%BB%B2%E6%98%A5%E6%9D%82%E8%AE%B0%E2%80%94%E2%80%94%E6%94%B6%E9%9B%86%E4%B8%80%E4%BA%9B%E7%9D%A1%E5%89%8D%E6%83%B3%E6%B3%95/" title="癸卯仲春杂记——收集一些睡前想法">癸卯仲春杂记——收集一些睡前想法</a><time datetime="2023-04-02T15:11:58.000Z" title="Created 2023-04-02 23:11:58">2023-04-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/23/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-Writeup-2/" title="Dest0g3 520迎新赛 Writeup(2)">Dest0g3 520迎新赛 Writeup(2)</a><time datetime="2023-03-23T10:51:12.000Z" title="Created 2023-03-23 18:51:12">2023-03-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/16/HSCSEC-2th-Writeup/" title="HSCSEC-2th Writeup">HSCSEC-2th Writeup</a><time datetime="2023-03-16T11:43:12.000Z" title="Created 2023-03-16 19:43:12">2023-03-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Ivy</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>